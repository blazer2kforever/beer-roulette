(()=>{"use strict";var e="popup_state_show",t=".wheel__sector",o="wheel__sector_lose",n=".wheel__sector-text",r="wheel__sector_blurred",i="select__mode_active",s=["The day wasn't too hard.","I'm a bit tired, but it's bearable.","I definitely need to rest.","A crate of beer. Right now."];function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function a(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!=c(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}var u=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.object=document.querySelector(".overlay")},(t=[{key:"hide",value:function(e){var t=this;this.object&&e&&(this.object.style.animation="fade-out ".concat(e,"s ease forwards"),this.object.addEventListener("animationend",(function(){t.object.style.visibility="hidden",console.log("Overlay hidden")}),{once:!0}))}},{key:"show",value:function(e){this.object&&e&&(this.object.style.visibility="visible",this.object.style.animation="fade-in ".concat(e,"s ease forwards"),console.log("Overlay displayed"))}},{key:"dim",value:function(e){this.object&&e&&(this.object.style.visibility="visible",this.object.style.animation="fade-in-80percent ".concat(e,"s ease forwards"),console.log("Overlay dimmed"))}},{key:"getObject",value:function(){return this.object}}])&&a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!=f(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}var m=function(){return t=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.errorTemplate=document.querySelector("#popup-error-template").content},(o=[{key:"showError",value:function(t){var o=document.importNode(this.errorTemplate,!0).querySelector(".popup");o.querySelector(".popup__text").textContent=t,document.body.appendChild(o),setTimeout((function(){o.classList.add(e),console.log("Popup displayed")}),50),setTimeout((function(){o.classList.remove(e),o.addEventListener("transitionend",(function(){o.remove(),console.log("Popup hidden")}),{once:!0})}),5e3)}}])&&d(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,o}();function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function b(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e){if("object"!=h(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!=h(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==h(t)?t:t+""}var v=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.popups=t,this.rouletteObject=document.querySelector(".roulette"),this.wheelObject=document.querySelector(".wheel"),this.wheelCover=document.querySelector(".wheel__cover"),this.sectors=[],this.loseSectorIndices=[],this.animationPhase="idling"},(i=[{key:"createSectors",value:function(){for(var e=document.getElementById("sector-template").content,o=0;o<10;o++){var n=document.importNode(e,!0).querySelector(t),r=36*o;n.style.transform="rotate(".concat(r,"deg)"),this.wheelObject.appendChild(n)}this.sectors=document.querySelectorAll(t),console.log("Generated ".concat(this.sectors.length," sectors for the roulette"))}},{key:"defineLoseSectors",value:function(e){for(var t=[];t.length<e;){var r=Math.floor(Math.random()*this.sectors.length);t.includes(r)||(t.push(r),this.sectors[r].classList.add(o),this.sectors[r].querySelector(n).textContent="Don't")}this.loseSectorIndices=t,console.log("Losing sectors are defined: ".concat(this.loseSectorIndices,"\nChance of winning: ").concat((10-this.loseSectorIndices.length)/10))}},{key:"clearSectors",value:function(){this.loseSectorIndices=[],this.sectors.forEach((function(e){e.classList.contains(o)&&(e.classList.remove(o),e.querySelector(n).textContent="Drink")}))}},{key:"normalizeAngle",value:function(e){return e%360}},{key:"findSectorIndex",value:function(e){for(var t=[{index:0,from:0,to:17},{index:9,from:18,to:54},{index:8,from:55,to:90},{index:7,from:91,to:126},{index:6,from:127,to:162},{index:5,from:163,to:198},{index:4,from:199,to:234},{index:3,from:235,to:270},{index:2,from:271,to:306},{index:1,from:307,to:342},{index:0,from:343,to:360}],o=0;o<t.length;o++)if(e>=t[o].from&&e<=t[o].to)return t[o].index;return null}},{key:"start",value:function(){var e=this;this.animationPhase="placing",this.wheelObject.classList.remove("wheel_idle"),this.rouletteObject.classList.add("roulette_place"),this.rouletteObject.addEventListener("transitionend",(function(){e.animationPhase="spinning",e.spin()}),{once:!0})}},{key:"spin",value:function(){var e=this,t=1080+Math.ceil(1080*Math.random()),o=this.normalizeAngle(t),n=this.findSectorIndex(o),i=this.loseSectorIndices.includes(n)?"lose":"win";console.log("Original angle: "+t+"\n Normalized angle: "+o+"\n Result sector: "+n+"\n Result: "+i),this.popups.showError("Original angle: "+t+"\n Normalized angle: "+o+"\n Result sector: "+n+"\n Result: "+i),this.wheelObject.style.transition="transform 7s cubic-bezier(0.050, 0.000, 0.180, 1.000)",this.wheelObject.style.transform="rotate("+t+"deg)",this.sectors.forEach((function(e){e.classList.add(r)})),this.wheelObject.addEventListener("transitionend",(function(){e.animationPhase="stopped",e.sectors.forEach((function(e){e.classList.remove(r)})),e.sectors[n].classList.add("wheel__sector_glow")}),{once:!0})}}])&&b(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i}();function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function w(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function g(e){var t=function(e){if("object"!=S(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!=S(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==S(t)?t:t+""}var j,L,_,E=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.modes=document.querySelectorAll(".select__mode")},(t=[{key:"setActiveMode",value:function(e){var t=this;this.modes.forEach((function(o){o.addEventListener("click",(function(){if(!o.classList.contains(i)){t.modes.forEach((function(e){e.classList.contains(i)&&e.classList.remove(i)})),o.classList.add(i);var n=Array.from(t.modes).indexOf(o);switch(document.querySelector(".select__text").textContent=s[n],e.clearSectors(),n){case 0:default:e.defineLoseSectors(5);break;case 1:e.defineLoseSectors(3);break;case 2:e.defineLoseSectors(1);break;case 3:e.defineLoseSectors(0)}}}))}))}},{key:"disableModes",value:function(){this.modes.forEach((function(e){e.disabled=!0}))}}])&&w(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),O=document.getElementById("start");document.addEventListener("DOMContentLoaded",(function(){console.log("Initialization..."),j=new m,(new u).hide(1.5),(L=new v(j)).createSectors(),L.defineLoseSectors(5),O.addEventListener("click",(function(){O.disabled=!0,_.disableModes(),L.start()})),(_=new E).setActiveMode(L)}),{once:!0})})();